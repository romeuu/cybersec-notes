13-02-2025 19:22
Status: #idea
Tags: [[Assesment Methodologies]]


- [[#Windows|Windows]]
	- [[#Windows#Servicios comunes a exploits|Servicios comunes a exploits]]


# Vulnerability Assessment

Esta sección nos mostrará el proceso de identificar, analizar y priorizar vulnerabilidades en sistemas, redes y aplicaciones. Su objetivo será detectar las posibles debilidades de seguridad antes de que un atacante pueda explotarlas.

En esta etapa, nos encargaremos de identificar las vulnerabilidades, pero no de explotarlas, por lo tanto, usaremos herramientas como Nessus, o MSF.


## Windows

En Windows podremos ver vulnerabilidades como:

- Information disclosure.
- Buffer Overflows.
- Remote Code Execution (RCE).
- Privilege Escalation.
- Denial of Service (DOS).

### Servicios comunes a exploits

Windows de por si tiene varios servicios nativos y diversos protocolos que se ejecutan por defecto.

Estos servicios proporcionan al atacante un vector de ataque que se podría usar para comprometer un equipo.

Aquí tenemos algunos servicios comunes a exploits:

- **Microsoft ISS** (Internet Information Services): 
	- Puerto 80/443. 
	- Es un servidor web que ha desarrollado Microsoft.

- **WebDAV** (Web Distributed Authoring & Versioning):
	- Puerto 80/443.
	- Es una extensión HTTP que permite a los clientes actualizar, borrar, mover o copiar ficheros en un servidor web.

- **SMB/CIFS** (Server Message Block Protocol): 
	- Puerto 445.
	- Es un protocolo para compartir ficheros a través de una red.

- **RDP** (Remote Desktop Protocol):
	- Puerto 3389.
	- Protocolo GUI propietario de Windows para acceder a equipos de manera remota.

- **WinRM** (Windows Remote Management Protocol):
	- Puerto 5986/443.
	- Es un protocolo que permite gestionar equipos de manera remota. Funciona a través de la red y permite ejecutar comandos, administrar servicios, y obtener información del sistema.


### Exploiting WebDAV

El primer paso para exploitear WebDAV será identificar si WebDAV está configurado en el servidor ISS.

Después, podremos hacer un ataque bruteforce para obtener credenciales válidas que nos permitan autenticarnos. Este último paso nos permitirá subir un fichero .asp maligno, que nos permitirá ejecutar comandos o iniciar una reverse shell en el objetivo.

#### Herramientas

- **davtest**: Se usa para escanear, autenticar y exploitear servidores WebDAV. Viene preinstalado en Kali y Parrot OS.

- **cadaver**: Cadaver nos permitirá subir, descargar, ver y editar ficheros, además de manipulación de propiedades, namespaces, colecciones, etc. Viene preinstalado en Kali y Parrot OS también.

#### Demostración

##### Enumeración

Para empezar, tendremos que enumerar si nuestro objetivo tiene WebDAV funcionando, para eso podremos usar nmap y escanear los puertos de este.

```bash
nmap -sV -sC 10.10.10.10
```

Con esto podremos confirmar si está WebDAV funcionando.

Para obtener más información, podremos usar el script de nmap **http-enum** de la siguiente manera:

```bash
nmap -sV -p 80 --script=http-enum
```

Este script nos dará normalmente la carpeta donde se encuentra la instalación de WebDAV.

##### Bruteforcing

Podremos usar hydra para esto, proporcionando una wordlist para los usuarios y otra para las contraseñas:

```bash
hydra -L /usr/share/wordlists/metasploit/common_users.txt -P /usr/share/wordlists/metasploit/common_passwords.txt 10.10.10.10 http-get /webdav/
```

##### Exploiting

Podremos usar **davtest**, y **cadaver** como hemos comentado anteriormente para subir ficheros y conseguir vulnerar el target.

```bash
davtest -auth bob:password_123321 -url http://10.10.10.10/webdav
```

Posteriormente, davtest nos dará una lista de ficheros que se pueden subir al servidor, y que se podrían ejecutar, mostrándonos así las extensiones que se pueden ejecutar.

Una vez que sepamos esto, podremos usar cadaver para vulnerar el objetivo:

```shell
cadaver http://10.10.10.10/webdav
```

Nos pedirá las credenciales, y posteriormente vemos como tenemos una shell que nos permitirá subir ficheros y hacer operaciones básicas.

Buscaremos shells que vengan en Kali por defecto en la ruta **/usr/share/webshells** adaptadas a la extensión que se pueda ejecutar en el servidor WebDAV.

Con este comando podremos subir el shell al servidor WebDAV:

```shell
put /usr/share/webshells/asp/webshell.asp
```

En el caso de que sea asp, si ejecutamos el shell en el servidor, veremos como nos da un input en el que podemos pasar los comandos que queramos, y nos mostrará su respuesta.


---
# Backlinks

```dataview
LIST
FROM [[]]
SORT file.name ASC
```
